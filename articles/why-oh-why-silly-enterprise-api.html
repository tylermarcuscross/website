<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="../static/css/style.css">
    <link rel="stylesheet" href="../static/css/article.css">
    <link rel="icon" type="image/png" href="../static/favicon.ico">
    <title>Struggles with Enterprise API Documentation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <nav class="terminal-links">
        <ul>
            <li><a href="../index.html">cd ..</a></li>
        </ul>
    </nav>

    <article class="terminal-article">
        <h1>A Guide to Acuity Scheduling's Enterprise API</h1>
        <time datetime="2025-01-06">2025-01-06</time>
        
        <section>
            <h2>Introduction</h2>
            <p>
                I've spent a lot of time working this out, and because I want it to mean something, I'm writing this guide. Before you think, why bother, can't I just hear from them via their <a href="https://enterprise-scheduling.readme.io/reference/overview">documentation</a> and support? Start with this and thank me later. If you're doing anything interesting with the enterprise API, you're probably leveraging it's ability to manage availability groups. This post will focus on those endpoints and how to understand and leverage them.
            </p>
        </section>

        <section>
            <h2>Bad Documentation...</h2>
            <p>
                One of the most confusing aspects of the Acuity Enterprise API documentation is how it presents availabilityGroupIDs and calendarIDs as two distinct concepts. In reality, availability groups are just a special type of calendar, and understanding this relationship is key to working with the API.
            </p>

            <figure>
                <img src="../static/images/acuity-delete-availability-group.png" alt="Screenshot of Acuity's API documentation showing the Delete an appointment group endpoint" />
                <figcaption>DELETE an appointment group for provided calendar suggests a seperation between availabilityGroupID and calendarID</figcaption>
            </figure>

            <p>
                Here's how it actually works: Every calendar has a default availability group, and for this first group, the availabilityGroupID is identical to the calendarID. When you create additional availability groups for a calendar, Acuity generates new unique IDs for these groups. While these IDs are different from the original calendarId, they function similarly in many ways. For example, you can use these IDs interchangeably with calendarID in endpoints like:
            </p>

            <ul>
                <li>The <a href="https://enterprise-scheduling.readme.io/reference/post_users-effectiveuserid-calendars-calendarid-override-hours-1">"Upsert override hours for a calendar"</a> POST endpoint</li>
                <li>The <a href="https://enterprise-scheduling.readme.io/reference/patch_users-effectiveuserid-calendars-calendarid-regular-hours-1">"Update regular hours for a calendar"</a> PATCH endpoint</li>
            </ul>

            <p>
                This relationship isn't clearly documented, which can lead to confusion when implementing calendar management features, especially those involving multiple availability groups.
            </p>

            <p>
                Since these availabilityGroupIDs are generated by Acuity, it's better to identify groups based on the appointment types they contain. You can fetch all availability groups for a calendar using the service-groups endpoint:
            </p>

            <pre><code>curl --request GET \
     --url https://acuityscheduling.com/api/enterprise/v1/users/effectiveUserId/calendars/calendarId/service-groups \
     --header 'accept: application/json'</code></pre>

            <p>
                The response will include the appointment types associated with each group. Use this to identify the specific group you need, then use that group's ID in the calendar manipulation endpoints mentioned above to make your desired changes.
            </p>
        </section>


        <section>
            <h2>An Example</h2>
            <p>
                Let's say we want to update the hours for a specific availability group. We can use the override-hours endpoint to do this.
            </p>

            <p>
                The override-hours endpoint can be used to manage both calendar and availability group hours. Remember, when updating override hours for a specific availability group, you use the availability groupID in place of the calendarID parameter. Previously, this endpoint had a quirk where it would return misleading data, but after some communication with Acuity's team, they've patched this behavior. Here's an example:
            </p>

            <pre><code>curl -X POST "https://acuityscheduling.com/api/enterprise/v1/users/{effectiveUserId}/calendars/10973203/override-hours" \
-d '{
    "hours": {
      "Monday": [],
      "Tuesday": ["9:00am-5:00pm"],
      ...
    },
    "start": "2024-11-05",
    "end": "2024-11-05"
}'</code></pre>

            <p>
                While you should receive a response that accurately reflects your update, I'd recommend testing your implementation with a subsequent GET request to verify you've updated the correct availability group.
            </p>

            <p>
                The response you'll get should look something like this:
            </p>

            <pre><code>{"data":[{
    "id":16473675913,
    "calendarId":10973203,
    "start":"2024-11-05",
    "end":"2024-11-05",
    "hours":{
        "Monday":[],
        "Tuesday":["9:00am-5:00pm"],
        ...
    }
}]}</code></pre>

            <p>
                The GET response confirms our update was successful, showing the correct calendarId and hours. While this endpoint previously returned inconsistent data, Acuity has since fixed this behavior, making it more reliable for calendar management operations.
            </p>
        </section>

    </article>
</body>
</html> 