<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="../static/css/style.css">
    <link rel="stylesheet" href="../static/css/article.css">
    <link rel="icon" type="image/png" href="../static/favicon.ico">
    <title>Struggles with Documentation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <nav class="terminal-links">
        <ul>
            <li><a href="../index.html">cd ..</a></li>
        </ul>
    </nav>

    <article class="terminal-article">
        <h1>A Guide to Acuity Scheduling's Enterprise API</h1>
        <time datetime="2025-01-06">2025-01-06</time>
        
        <section>
            <p>
                I've spent a lot of time reverse engineering this API, and because I want it to mean something, I'm writing this guide. Before you think, why bother, can't I just hear from them via their <a href="https://enterprise-scheduling.readme.io/reference/overview">documentation</a> and support? Start with this and thank me later. 
            </p>
        </section>

        <section>
            <h2>Dazed and Confused...</h2>
            <p>
                If you're doing anything interesting with the enterprise API, you're probably leveraging its ability to manage <em>availability groups</em> to dynamically manage appointment type availability. You might have read their API documentation, and it might have you thinking <code>availabilityGroupID</code> and <code>calendarID</code> are two different things, because it separates them out as two different parameters, and it gives them two different names. In reality, availability groups are just a <em>special type of calendar</em>, and understanding this is the key to working with the API. Take this screenshot for example:
            </p>

            <figure>
                <img src="../static/images/acuity-delete-availability-group.png" alt="Screenshot of Acuity's API documentation showing the Delete an appointment group endpoint" />
                <figcaption>DELETE an appointment group for provided calendar suggests a seperation between availabilityGroupID and calendarID</figcaption>
            </figure>

            <p>
                You can pass calendarID, availabilityGroupID, or both to the API, and that seperation is misleading. Here's what's really going on: every calendar has a default availability group, and for this first group, the <code>availabilityGroupID</code> is identical to the <code>calendarID</code>. When you create additional availability groups for a calendar, Acuity generates new unique IDs for these groups. While these IDs are different from the original <code>calendarID</code>, they function similarly in many ways. 
            </p>

            <p>
                Once you understand this, you can use these IDs interchangeably with calendarID in endpoints like:
            </p>

            <ul>
                <li>The <a href="https://enterprise-scheduling.readme.io/reference/post_users-effectiveuserid-calendars-calendarid-override-hours-1">"Upsert override hours for a calendar"</a> POST endpoint</li>
                <li>The <a href="https://enterprise-scheduling.readme.io/reference/patch_users-effectiveuserid-calendars-calendarid-regular-hours-1">"Update regular hours for a calendar"</a> PATCH endpoint</li>
            </ul>

            <p>
                This relationship isn't clearly documented, which can lead to confusion when implementing calendar management features, especially those involving multiple availability groups.
            </p>

            <p>
                Since these <code>availabilityGroupIDs</code> are generated by Acuity, it's better to identify groups based on the appointment types they contain, since you probably have a system that already knows what these types are. You can fetch all availability groups for a calendar using the GET service-groups endpoint:
            </p>

            <pre><code>curl --request GET \
     --url https://acuityscheduling.com/api/enterprise/v1/users/effectiveUserId/calendars/calendarId/service-groups \
     --header 'accept: application/json'</code></pre>

            <p>
                The response will include the appointment types associated with each group. Use this to identify the specific group you need, then use that group's ID in the calendar manipulation endpoints mentioned above to make your desired changes.
            </p>
        </section>


        <section>
            <h2>An Example</h2>
            <p>
                Let's say we want to update the hours for a specific availability group. We can use the override-hours endpoint to do this.
            </p>

            <p>
                The override-hours endpoint can be used to manage both calendar and availability group hours. Remember, when updating override hours for a specific availability group, you use the <code>availabilityGroupID</code> in place of the <code>calendarID</code> parameter. Previously, this endpoint had a quirk where it would return misleading data, but after some communication with Acuity's team, they've patched this behavior. Here's an example:
            </p>

            <pre><code>curl -X POST "https://acuityscheduling.com/api/enterprise/v1/users/{effectiveUserId}/calendars/10973203/override-hours" \
-d '{
    "hours": {
      "Monday": [],
      "Tuesday": ["9:00am-5:00pm"],
      ...
    },
    "start": "2024-11-05",
    "end": "2024-11-05"
}'</code></pre>

            <p>
                While you should receive a response that accurately reflects your update, I'd recommend testing your implementation with a subsequent GET request to verify you've updated the correct availability group.
            </p>

            <p>
                The response you'll get should look something like this:
            </p>

            <pre><code>{"data":[{
    "id":16473675913,
    "calendarId":10973203,
    "start":"2024-11-05",
    "end":"2024-11-05",
    "hours":{
        "Monday":[],
        "Tuesday":["9:00am-5:00pm"],
        ...
    }
}]}</code></pre>

            <p>
                Hopefully, the GET response confirms our update was successful, showing the correct <code>calendarID</code> and hours. While this endpoint previously returned inconsistent data, Acuity has promised to have fixed this behavior, making it more reliable for calendar management operations.
            </p>
        </section>

        <section>
            <h2>Conclusion</h2>
            <p>
                The Acuity Enterprise API has its quirks, but it's potentially the only option for <em>dynamically managing availability</em> for different appointment types if you've built your systems around their platform. In another post, I'll cover how build a system using ML to balance appointment availability with this API.
            </p>
        </section>

    </article>
</body>
</html> 